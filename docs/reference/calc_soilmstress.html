<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculates an empirical soil moisture stress factor — calc_soilmstress • rpmodel</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous"><!-- Fonts --><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Titillium+Web:ital,wght@0,300;0,400;0,700;1,300;1,400&amp;display=swap" rel="stylesheet"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- geco --><link href="../geco.css" rel="stylesheet"><meta property="og:title" content="Calculates an empirical soil moisture stress factor — calc_soilmstress"><meta property="og:description" content="Calculates an empirical soil moisture stress factor as a function of relative
soil moisture (fraction of field capacity)."><meta property="og:image" content="/logo.png"><meta name="twitter:card" content="summary"><!-- Mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js" async integrity="sha256-nlrDrBTHxJJlDDX22AS33xYI1OJHnGMDhiYMSe2U0e0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/config/TeX-AMS-MML_HTMLorMML.js" async integrity="sha256-4zys9A4hMQmtq2EUL+JRoXc0NZi8jVJMzb8onewOaSQ=" crossorigin="anonymous"></script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">

    <div class="navbar-header">

      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="external-link hidden-sm hidden-xs" href="https://computationales.ethz.ch/">
          <img src="https://raw.githubusercontent.com/computationales/GECO_template/main/geco_logo_small.png" id="hexlogo" alt="GECO"></a>
        <a class="external-link hidden-md hidden-lg" href="https://computationales.ethz.ch/">
          <img src="https://raw.githubusercontent.com/computationales/GECO_template/main/geco_logo_small.png" id="hexlogo" alt="GECO"></a>
        <a class="navbar-brand" href="../index.html">
           <i>rpmodel <small>v1.2.2</small></i>
        </a>
      </div>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/functional_dependencies.html">Summary of functional dependencies</a>
    </li>
    <li>
      <a href="../articles/usage.html">Running the P-model in R</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/computationales/rpmodel/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculates an empirical soil moisture stress factor</h1>
    <small class="dont-index">Source: <a href="https://github.com/computationales/rpmodel/blob/HEAD/R/subroutines.R" class="external-link"><code>R/subroutines.R</code></a></small>
    <div class="hidden name"><code>calc_soilmstress.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates an empirical soil moisture stress factor as a function of relative
soil moisture (fraction of field capacity).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calc_soilmstress</span><span class="op">(</span><span class="va">soilm</span>, meanalpha <span class="op">=</span> <span class="fl">1</span>, apar_soilm <span class="op">=</span> <span class="fl">0</span>, bpar_soilm <span class="op">=</span> <span class="fl">0.685</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>soilm</dt>
<dd><p>Relative soil moisture as a fraction
of field capacity (unitless). Defaults to 1.0 (no soil moisture stress).</p></dd>


<dt>meanalpha</dt>
<dd><p>Local annual mean ratio of actual over potential 
evapotranspiration, measure for average aridity. Defaults to 1.0.</p></dd>


<dt>apar_soilm</dt>
<dd><p>(Optional, used only if <code>do_soilmstress==TRUE</code>)
Parameter determining the sensitivity of the empirical soil moisture stress
function. Defaults to 0.0, the empirically fitted value as presented in Stocker
et al. (2019) Geosci. Model Dev. for model setup 'FULL' (corresponding to a setup
with <code>method_jmaxlim="wang17", do_ftemp_kphio=TRUE, do_soilmstress=TRUE</code>).</p></dd>


<dt>bpar_soilm</dt>
<dd><p>(Optional, used only if <code>do_soilmstress==TRUE</code>) Parameter
determining the sensitivity of the empirical soil moisture stress function. Defaults
to ~0.6, the empirically fitted value as presented in Stocker et al. (2019) Geosci. Model Dev.
for model setup 'FULL' (corresponding to a setup with <code>method_jmaxlim="wang17",
do_ftemp_kphio=TRUE, do_soilmstress=TRUE</code>).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A numeric value for \(\beta\)</p>


    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The soil moisture stress factor is calculated using a quadratic function that
is 1 above <code>soilm</code> = 0.6 and has a sensitivity, given by the y-axis cutoff,
(zero soil moisture), determined  by average aridity (argument <code>meanalpha</code>) as:
$$
    \beta = q(\theta - \theta*)^2 + 1
$$
for \(\theta &lt; \theta*\) and \(\beta = 1.0\) otherwise. \(\theta*\) is fixed at 0.6.
\(q\) is the sensitivity parameter and is calculated as a linear function of average aridity,
quantified by the local annual mean ratio of actual over potential evapotranspiration, termed
\(\alpha\):
$$
     q=(\beta0-1)/(\theta*-\theta0)^2
$$
\(\theta0\) is 0.0, and
$$
     \beta0 = a + b \alpha
$$
\(a\) is given by argument <code>apar</code>, \(b\) is given by argument <code>bpar</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Stocker, B. et al. Geoscientific Model Development Discussions (in prep.)</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Relative reduction (%) in GPP due to soil moisture stress at</span></span></span>
<span class="r-in"><span><span class="co">## relative soil water content ('soilm') of 0.2:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">(</span><span class="fu">calc_soilmstress</span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span> <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -14</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start bottom-8">
            <div class="col-xs-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/computationales" target="_blank" class="external-link">
                          <div class="icon fab fa-github"></div></a>
                        <a href="https://computationales.ethz.ch/" target="_blank" class="external-link">
                          <div class="icon fa fa-flask"></div></a>
                        <a href="http://twitter.com/SteniBocker/" target="_blank" class="external-link">
                          <div class="icon fab fa-twitter"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">About</h5>
                            <li><a href="https://computationales.ethz.ch/" class="external-link">Computationales</a></li>
                            <li><a href="https://computationales.ethz.ch/" class="external-link">Our Team</a></li>
                            <li><a href="https://computationales.ethz.ch/" class="external-link">Contact Us</a></li>
                        </ul></div>
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">Resources</h5>
                            <li><a href="https://github.com/computationales" class="external-link">Packages</a></li>
                            <li><a href="https://computationales.ethz.ch/" class="external-link">Publications</a></li>
                            <li><a href="https://computationales.ethz.ch/" class="external-link">Blog</a></li>
                        </ul></div>

                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->

      </footer></div>

  


  

  </body></html>

