<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Acclimated versus instantaneous response • rpmodel</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Acclimated versus instantaneous response">
<meta property="og:description" content="rpmodel">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rpmodel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/accl_inst.html">Acclimated versus instantaneous response</a>
    </li>
    <li>
      <a href="../articles/usage.html">Usage</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/stineb/rpmodel/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="accl_inst_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Acclimated versus instantaneous response</h1>
                        <h4 class="author">Beni Stocker</h4>
            
            <h4 class="date">2021-05-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stineb/rpmodel/blob/master/vignettes/accl_inst.Rmd"><code>vignettes/accl_inst.Rmd</code></a></small>
      <div class="hidden name"><code>accl_inst.Rmd</code></div>

    </div>

    
    
<div id="motivation" class="section level2">
<h2 class="hasAnchor">
<a href="#motivation" class="anchor"></a>Motivation</h2>
<p>The P-model predicts the “acclimated” response of photosynthetic parameters and stomatal sensitivity (Vcmax, Jmax, <span class="math inline">\(\xi\)</span>) to the environment and reflects the acclimation process by balanced investments to maintaining the photosynthetic apparatus and transpiration stream (essentially a trade-off between the capacities of light-harvesting and dark reactions on the one hand and stomatal aperture on the other hand). Irrespective of investments into the different photosynthetic capacities, there is an instantaneous response of different rates that are governed by enzymatic processes or simple physics. This means that the P-model (the results returned by a <code><a href="../reference/rpmodel.html">rpmodel()</a></code> function call) doesn’t predict instantaneous response, but only the more slowly acclimating responses. However, the instantaneous rates are sometimes relevant to consider, e.g., for comparison to observations. Using the same underlying principles and parametrisations as used in the P-model, we can calculate the instantaneous response from instantaneous environmental conditions and the FvCB photosynthesis model and the acclimated response from the P-model.</p>
<p>In order to make this separation of the acclimated and instantaneous response more explicit, two functions are introduced:</p>
<ol style="list-style-type: decimal">
<li>
<code><a href="../reference/dampen_vec.html">dampen_vec()</a></code>: Applies an exponential dampening with a specified time scale to all inputs (environmental variables) to which photosynthesis acclimates.</li>
<li>
<code><a href="../reference/inst_rpmodel.html">inst_rpmodel()</a></code>: Calculates instantaneous responses from outputs of <code><a href="../reference/rpmodel.html">rpmodel()</a></code>.</li>
</ol>
<div class="figure">
<img src="fig/fig_inst_accl.png" style="width:50.0%" alt=""><p class="caption"><em>Information flow for separating the acclimated and instantaneous responses with rpmodel.</em></p>
</div>
<p>This explicit separation allows for a clear application of the P-model to time series data which is given at a temporal resolution that is higher than the typical acclimation time scale. Below is a description of the theory and an example that illustrates such an application.</p>
</div>
<div id="theory" class="section level2">
<h2 class="hasAnchor">
<a href="#theory" class="anchor"></a>Theory</h2>
<p>The derivation of acclimated quantities Vcmax, Jmax, and <span class="math inline">\(\xi\)</span> are described in <a href="https://doi.org/10.5194/gmd-13-1545-2020">Stocker et al., 2020</a>. They can be used to calculate stomatal conductance <span class="math inline">\(g_s\)</span>, leaf internal CO2 concentration <span class="math inline">\(c_i\)</span>, and the assimilation rates <span class="math inline">\(A_J\)</span> and <span class="math inline">\(A_C\)</span> by simulataneously solving Eqs. C1, 5, in <a href="https://doi.org/10.5194/gmd-13-1545-2020">Stocker et al., 2020</a> and the standard FvCB equations for <span class="math inline">\(A_J\)</span> and <span class="math inline">\(A_C\)</span>. These are:</p>
<p><span class="math display">\[
g_s = \left( 1 + \frac{\xi}{\sqrt{D}} \right) \frac{A}{c_a - \Gamma^{\ast}}
\]</span></p>
<p><span class="math display">\[
A = g_s(c_a - c_i)
\]</span></p>
<p><span class="math display">\[
A_J = I_\text{abs} \; \varphi_0 \frac{c_i - \Gamma^\ast}{c_i + 2 \Gamma^\ast} L
\]</span> <span class="math display">\[
A_C = V_\text{cmax}  \frac{c_i - \Gamma^\ast}{c_i + K}
\]</span> <span class="math display">\[
A = \min(A_C, A_J)
\]</span></p>
<p>With <span class="math inline">\(L = \frac{1}{\sqrt{1 + \left( \frac{4\varphi_0 I_\text{abs}}{J_\text{max}} \right)^2}}\)</span></p>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<div id="synthetic-data" class="section level3">
<h3 class="hasAnchor">
<a href="#synthetic-data" class="anchor"></a>Synthetic data</h3>
<p>We first create a data frame of daily inputs <span class="math inline">\(X(t)\)</span> for one year. This is some syntetic data with a seasonality.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Attaching package: 'dplyr'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>doy <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">365</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    tc     <span class="op">=</span> <span class="fl">30</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">doy</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="op">(</span><span class="fl">365</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">365</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,
    vpd    <span class="op">=</span> <span class="fl">1000</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">365</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,
    co2    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">400</span>, <span class="fl">365</span><span class="op">)</span>,
    fapar  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">365</span><span class="op">)</span>,
    ppfd   <span class="op">=</span> <span class="fl">25</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">doy</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="op">(</span><span class="fl">365</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">5</span>
  <span class="op">)</span>

<span class="va">df</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">doy</span>, <span class="va">tc</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="accl_inst_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">doy</span>, <span class="va">ppfd</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span></code></pre></div>
<p><img src="accl_inst_files/figure-html/unnamed-chunk-1-2.png" width="700"></p>
</div>
<div id="dampen-inputs" class="section level3">
<h3 class="hasAnchor">
<a href="#dampen-inputs" class="anchor"></a>Dampen inputs</h3>
<p>Next, calculated temporally damped input time series. This can be done with the function <code>dampen_vec</code> (newly added for rpmodel package version 1.2). Here we chose a dampening (e-folding) time scale of 40 days (<code>tau = 40</code>).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stineb/rpmodel">rpmodel</a></span><span class="op">)</span>
<span class="va">df_damped</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_at</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/one_of.html">one_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"tc"</span>, <span class="st">"vpd"</span>, <span class="st">"co2"</span>, <span class="st">"fapar"</span>, <span class="st">"ppfd"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="va">dampen_vec</span>, tau <span class="op">=</span> <span class="fl">40</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">doy</span>, <span class="va">tc</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_damped</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">doy</span>, <span class="va">tc</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p><img src="accl_inst_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div id="calculate-acclimated-response" class="section level3">
<h3 class="hasAnchor">
<a href="#calculate-acclimated-response" class="anchor"></a>Calculate acclimated response</h3>
<p>Now, we can apply the P-model to the damped time series.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org">purrr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>

<span class="va">df_out</span> <span class="op">&lt;-</span> <span class="va">df_damped</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span> out_pmodel <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">pmap</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.</span>, <span class="op">-</span><span class="va">doy</span><span class="op">)</span>, <span class="va">rpmodel</span>, 
    elv            <span class="op">=</span> <span class="fl">0</span>,         
    kphio          <span class="op">=</span> <span class="fl">0.05</span>,         
    beta           <span class="op">=</span> <span class="fl">146</span>,
    c4             <span class="op">=</span> <span class="cn">FALSE</span>,
    method_optci   <span class="op">=</span> <span class="st">"prentice14"</span>,
    method_jmaxlim <span class="op">=</span> <span class="st">"wang17"</span>,
    do_ftemp_kphio <span class="op">=</span> <span class="cn">FALSE</span>
    <span class="op">)</span> <span class="op">)</span></code></pre></div>
</div>
<div id="calculate-instantaneous-response" class="section level3">
<h3 class="hasAnchor">
<a href="#calculate-instantaneous-response" class="anchor"></a>Calculate instantaneous response</h3>
<p>Using the acclimated quantities, we can now calculate daily instantaneous rates using the same underlying parametrisations (for assimilation, etc.). This uses acclimated Vcmax, Jmax, and <span class="math inline">\(\xi\)</span> from the <code>rpmodel</code> call and applies the FvCB photosynthesis parametrisation (the same as is underlying the P-model theory), with its non-linear dependency of <span class="math inline">\(A_J\)</span> to absorbed light. The P-model application as described here thus describes the non-linearity of absorbed light and assimilation and the strong temperature dependency of respiration at the fast time scale (at which photosynthesis is not acclimated), and at the same time the emergent linearity between absorbed light and assimilation and acclimating respiration at the longer time scale. This emergent behavior follows from the P-model theory.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_out</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">df_out</span>, <span class="va">doy</span>, <span class="va">out_pmodel</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"doy"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>out_inst <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">pmap</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.</span>, x <span class="op">=</span> <span class="va">out_pmodel</span>, <span class="va">tc</span>, <span class="va">vpd</span>, <span class="va">co2</span>, <span class="va">fapar</span>, <span class="va">ppfd</span><span class="op">)</span>, 
                                <span class="va">inst_rpmodel</span>,
                                elv <span class="op">=</span> <span class="fl">0</span>, 
                                kphio <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="accl_inst_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p><img src="accl_inst_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>The curves should be identical if the damped forcing is provided as input to <code><a href="../reference/inst_rpmodel.html">inst_rpmodel()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## using damped inputs here</span>
<span class="va">df_out2</span> <span class="op">&lt;-</span> <span class="va">df_damped</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">df_out</span>, <span class="va">doy</span>, <span class="va">out_pmodel</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"doy"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>out_inst <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">pmap</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.</span>, x <span class="op">=</span> <span class="va">out_pmodel</span>, <span class="va">tc</span>, <span class="va">vpd</span>, <span class="va">co2</span>, <span class="va">fapar</span>, <span class="va">ppfd</span><span class="op">)</span>, 
                                <span class="va">inst_rpmodel</span>,
                                elv <span class="op">=</span> <span class="fl">0</span>, 
                                kphio <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="accl_inst_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Ok.</p>
<p>The difference between an acclimating respiration (using acclimating Vcmax25 and the instantaneous temperature scaling of Rd), vs. a hypothetical non-acclimating respiration (using a seasonally constant mean Vcmax25 and the same instantaneous temperature scaling of Rd) is illustrated below. <img src="accl_inst_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_ramp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>
    idx    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">50</span><span class="op">)</span>,
    tc     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">50</span><span class="op">)</span>,
    vpd    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">50</span><span class="op">)</span>,
    co2    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">400</span>, <span class="fl">50</span><span class="op">)</span>,
    fapar  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">50</span><span class="op">)</span>,
    ppfd   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">50</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">df_out</span> <span class="op">&lt;-</span> <span class="va">df_ramp</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span> out_pmodel <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">pmap</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.</span>, <span class="op">-</span><span class="va">idx</span><span class="op">)</span>, <span class="va">rpmodel</span>, 
    elv            <span class="op">=</span> <span class="fl">0</span>,         
    kphio          <span class="op">=</span> <span class="fl">0.05</span>,         
    beta           <span class="op">=</span> <span class="fl">146</span>,
    c4             <span class="op">=</span> <span class="cn">FALSE</span>,
    method_optci   <span class="op">=</span> <span class="st">"prentice14"</span>,
    method_jmaxlim <span class="op">=</span> <span class="st">"wang17"</span>,
    do_ftemp_kphio <span class="op">=</span> <span class="cn">FALSE</span>
    <span class="op">)</span> <span class="op">)</span>

<span class="va">df_out</span> <span class="op">&lt;-</span> <span class="va">df_ramp</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">df_out</span>, <span class="va">idx</span>, <span class="va">out_pmodel</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"idx"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>out_pmodel_mid <span class="op">=</span> <span class="va">out_pmodel</span><span class="op">[</span><span class="fl">25</span><span class="op">]</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>out_inst <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">pmap</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.</span>, x <span class="op">=</span> <span class="va">out_pmodel_mid</span>, <span class="va">tc</span>, <span class="va">vpd</span>, <span class="va">co2</span>, <span class="va">fapar</span>, <span class="va">ppfd</span><span class="op">)</span>, 
                                <span class="va">inst_rpmodel</span>,
                                elv <span class="op">=</span> <span class="fl">0</span>, 
                                kphio <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="accl_inst_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Stocker Benjamin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
